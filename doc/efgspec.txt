$Source$
$Date$
$Revision$

SPECIFICATION OF EXTENSIVE FORM FILE FORMAT
Last modified: 3 Dec 2001, TLT
Rekeyed from hardcopy dated 12 Jul 1995

================================================

The revised .efg file format provides for a compact yet readable specification
of an extensive form game.  A sample file is provided below, and contains
all the key elements found in the file format.

SAMPLE GAME:

EFG 2 D "General Bayes game, one stage" { "Player 1" "Player 2" }
c "ROOT" 1 "(0,1)" { "1G" 0.500000 "1B" 0.500000 } 0
c "" 2 "(0,2)" { "2g" 0.500000 "2b" 0.500000 } 0
p "" 1 1 "(1,1)" { "H" "L" } 0
p "" 2 1 "(2,1)" { "h" "l" } 0
t "" 1 "Outcome 1" { 10.000000 2.000000 }
t "" 2 "Outcome 2" { 0.000000 10.000000 }
p "" 2 1 "(2,1)" { "h" "l" } 0
t "" 3 "Outcome 3" { 2.000000 4.000000 }
t "" 4 "Outcome 4" { 4.000000 0.000000 }
p "" 1 1 "(1,1)" { "H" "L" } 0
p "" 2 2 "(2,2)" { "h" "l" } 0
t "" 5 "Outcome 5" { 10.000000 2.000000 }
t "" 6 "Outcome 6" { 0.000000 10.000000 }
p "" 2 2 "(2,2)" { "h" "l" } 0
t "" 7 "Outcome 7" { 2.000000 4.000000 }
t "" 8 "Outcome 8" { 4.000000 0.000000 }
c "" 3 "(0,3)" { "2g" 0.500000 "2b" 0.500000 } 0
p "" 1 2 "(1,2)" { "H" "L" } 0
p "" 2 1 "(2,1)" { "h" "l" } 0
t "" 9 "Outcome 9" { 4.000000 2.000000 }
t "" 10 "Outcome 10" { 2.000000 10.000000 }
p "" 2 1 "(2,1)" { "h" "l" } 0
t "" 11 "Outcome 11" { 0.000000 4.000000 }
t "" 12 "Outcome 12" { 10.000000 2.000000 }
p "" 1 2 "(1,2)" { "H" "L" } 0
p "" 2 2 "(2,2)" { "h" "l" } 0
t "" 13 "Outcome 13" { 4.000000 2.000000 }
t "" 14 "Outcome 14" { 2.000000 10.000000 }
p "" 2 2 "(2,2)" { "h" "l" } 0
t "" 15 "Outcome 15" { 0.000000 4.000000 }
t "" 16 "Outcome 16" { 10.000000 0.000000 }

END OF SAMPLE GAME

In general, whitespace (carriage returns, horizontal and vertical tabs, and
spaces) do not have an effect on the meaning of the file.  The only exception
is inside explicit double-quotes, where all characters are significant.  The
formatting shown here is the same as generated by the GAMBIT code and 
has been chosen for its readability; other formattings are possible (and
legal).

The extensive form file consists of two parts: the prologue, or header, and
the list of nodes, or body.  In this file, the prologue is the first line.
(Again, this is just a consequence of the formatting we have chosen and
is not a requirement of the file structure itself.)  The prologue is
constructed as follows: the first five characters must be

EFG 2

The EFG is a tag indicating that what follows is an extensive form.  The
2 is actually a version number; the only currently supported format is
2, so all valid files currently will have a 2 there.

COMMENT (TLT, 3 Dec 2001): This next paragraph is obsolete; the 'D' or 'R'
is now ignored by GAMBIT, and the numbers in the file are determined to
be floating-point or rational by context.  It is permitted to mix and
match floating-point and rational numbers in the same file.  All files
must still have the 'D' or 'R' in this position, however.

The next character is either a D or R, and specifies the precision in
which the game is represented.  D indicates the game is to be interpreted
as being represented in the machine's native double-precision floating
point format, and an R means the game should be represented using
arbitrary precision rational numbers (which are built into GAMBIT and
do not vary from machine to machine).  The actual representation of the
numbers in the file does not depend on this choice: for example, GAMBIT
will convert floating-point numbers in the file to rationals in memory
if R is specified.

IMPLEMENTATION NOTE: The current GAMBIT implementation requires that the
first six characters of the file be 'EFG 2 ', followed by a D or R, as
in the sample file above.  This is an exception to the whitespace rules
given above.  We apologize for any inconvenience.

The prologue continues with the title of the game.  The title, like all
text strings, is explicitly delimited with double-quote characters, and all
characters inside the quotes are considered significant.  Note that there
is currently no provision for using an explicit double-quote character
as part of a game.  Following the title is a list of the names of the
players defined in the game.  This list follows the convention found 
elsewhere in the file of being surrounded by curly braces and delimited
by whitespace (but _not_ commas, semicolons, or any other character).
The order of the players is significant in a way which will be described
later.  This completes the prologue.


The body of the file lists the nodes which comprise the extensive form.
These nodes are listed in the prefix traversal of the tree.  The prefix
traversal for a subtree is defined as being the root node of the subtree,
followed by the prefix traversal of the subtree rooted by each child,
in order from first to last.  Thus, for the whole tree, the root node
appears first, followed by the prefix traversals of its child subtrees.
For convenience, the game above follows the convention of one line per
node.

Each node entry begins with an unquoted character indicating the type of
the node.  There are three node types:
            c       chance node
            p       personal player node
            t       terminal node
Each node type will be discussed individually below.  There are three numbering
conventions which are used to identify the information structure of the tree.
Wherever a player number is called for, the integer specified corresponds
to the index of the player in the player list from the prologue.  The first
player in the list is numbered 1, the second 2, and so on.  Information 
sets are identified by an arbitrary integer which is unique within the
player.  GAMBIT generates these numbers as 1, 2, etc. as they appear first
in the file, but there are no requirements other than uniqueness.  The
same integer may be used to specify information sets for different players;
this is not ambiguous since the player number appears as well.  Finally,
outcomes are also arbitrarily numbered in the file format in the same way
in which information sets are, except for the special number 0 which 
indicates the null outcome.

Information sets and outcomes may (and frequently will) appear multiple
times within a game.  By convention, the second and subsequent times an
information set or outcome appears, the file may omit the descriptive
information for that information set or outcome.  Alternatively, the
file may specify the descriptive information again; however, it must
precisely match the original declaration of the information set or outcome.
If any part of the description is omitted, the whole description must be
omitted.

In the following lists, a 'o' indicates a required field, a '*' indicates
a field which is omittable by the above rule.

CHANCE NODES:  Entries for chance nodes begin with the character c.  Following
this, in order, are:
        o a text string, giving the name of the node
        o an integer specifying the information set number
        * the name of the information set
        * a list of actions at the information set and their corresponding
          probabilities (see example game for an example)
        o an integer specifying the outcome
        * the payoffs to each player for the outcome

PERSONAL NODES:  Entries for personal player decision nodes begin with the
character p.  Following this, in order, are:
        o a text string, giving the name of the node
        o an integer specifying the player who owns the node
        o an integer specifying the information set
        * the name of the information set
        * a list of action names for the information set
        o an integer specifying the outcome
        * the payoffs to each player for the outcome

TERMINAL NODES:  Entries for terminal nodes begin with the character t.
Following this, in order, are:
        o a text string, giving the name of the node
        o an integer specifying the outcome
        * the payoffs to each player for the outcome


There is currently no explicit end-of-file delimiter for the extensive form
format.  Future expansion may introduce other elements which will appear
after the node list.



